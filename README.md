# üöå BookingProject ‚Äî —Å–∏—Å—Ç–µ–º–∞ –æ–Ω–ª–∞–π–Ω-–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤

**Pet-–ø—Ä–æ–µ–∫—Ç.** –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ –∞–≤—Ç–æ–±—É—Å—ã –∏ –º–∞—Ä—à—Ä—É—Ç–∫–∏ –ø–æ –ë–µ–ª–∞—Ä—É—Å–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ: –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∏ —Å–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç –ø–æ–∏—Å–∫–∞ —Ä–µ–π—Å–∞ –¥–æ –æ–ø–ª–∞—Ç—ã –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

–¶–µ–ª—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞–≤—ã–∫–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (Kafka, Saga), –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ (Stripe) –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Keycloak/JWT).

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: –ø–æ–∏—Å–∫ ‚Üí –±—Ä–æ–Ω—å ‚Üí –æ–ø–ª–∞—Ç–∞ ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ Saga pattern
- –û–±—Ä–∞–±–æ—Ç–∫–∞ edge-case: —Ç–∞–π–º–∞—É—Ç—ã, –ø–æ–≤—Ç–æ—Ä—ã, —Å–±–æ–∏
- Production-–ø–æ–¥—Ö–æ–¥ –∫ backend-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend**

- Java 21, Spring Boot 3.5+
- **PostgreSQL** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (booking, order, payment, trip, user, inventory)
- **Redis** ‚Äî –∫—ç—à (trip-service), –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (TTL)
- **Apache Kafka** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- Spring Cloud Gateway ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, JWT, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- Keycloak ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (OAuth2 / JWT). –ë–î Keycloak: MySQL
- Stripe API ‚Äî –æ–ø–ª–∞—Ç–∞ (Checkout Session, Webhook)
- gRPC ‚Äî —Å–≤—è–∑—å Booking ‚Üî Inventory (—Ä–µ–∑–µ—Ä–≤ –º–µ—Å—Ç)
- Docker & Docker Compose, Lombok, MapStruct, Flyway

**Frontend**

- React 18, TypeScript, Vite, Tailwind, Radix UI
- –ü–æ–∏—Å–∫ —Ä–µ–π—Å–æ–≤, –≤—ã–±–æ—Ä –º–µ—Å—Ç, —Ñ–æ—Ä–º–∞ –ø–∞—Å—Å–∞–∂–∏—Ä–∞, –æ–ø–ª–∞—Ç–∞ (Stripe Checkout), –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –∞–¥–º–∏–Ω-–¥–∞—à–±–æ—Ä–¥

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –¥–æ–º–µ–Ω–∞–º. –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –≤ PostgreSQL (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î –Ω–∞ —Å–µ—Ä–≤–∏—Å); Redis ‚Äî –∫—ç—à –∏ TTL-–±—Ä–æ–Ω–∏; Kafka ‚Äî —Å–æ–±—ã—Ç–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

**üîê API Gateway (api-gateway)**

- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è JWT (Keycloak)
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã, –ø—Ä–æ–±—Ä–æ—Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (userId, roles)
- Circuit breaker, fallback

**üöå Trip Service (trip-service)**

- –ú–∞—Ä—à—Ä—É—Ç—ã (–≥–æ—Ä–æ–¥ ‚Üí –≥–æ—Ä–æ–¥), —Ä–µ–π—Å—ã –ø–æ –¥–∞—Ç–∞–º, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, —Ü–µ–Ω–∞
- –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã: `GET /routes`, `GET /trips?from=...&to=...&date=...`, `GET /trips/{id}`
- –ë–î: PostgreSQL (trip_db). –ö—ç—à —Ä–µ–π—Å–æ–≤: Redis

**üì¶ Inventory Service (inventory-service)**

- –ú–µ—Å—Ç–∞ –≤ –∞–≤—Ç–æ–±—É—Å–µ: AVAILABLE, HELD (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –±—Ä–æ–Ω—å), CONFIRMED
- gRPC-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∞ –º–µ—Å—Ç. Redis + TTL –¥–ª—è –∞–≤—Ç–æ–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è
- –ë–î: PostgreSQL (inventory_db)

**üé´ Booking Service (booking-service)**

- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–π—Å–∞ ‚Üí gRPC-—Ä–µ–∑–µ—Ä–≤ –º–µ—Å—Ç (Inventory) ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (Order) ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã (Payment)
- –í–æ–∑–≤—Ä–∞—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ Stripe Checkout. –ü—Ä–∏ —Å–±–æ—è—Ö ‚Äî –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è (Kafka: booking.failed)
- –ë–î: PostgreSQL (booking_db)

**üßæ Order Service (order-service)**

- –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–∫–∞–∑–∞: PENDING ‚Üí CONFIRMED / CANCELLED
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Kafka: payment.succeeded, payment.failed, reservation.expired. –ß–∞—Å—Ç—å Saga
- –ë–î: PostgreSQL (order_db)

**üí≥ Payment Service (payment-service)**

- Stripe Checkout Session, –ø—Ä–∏—ë–º Webhook (payment_intent.succeeded / failed)
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ paymentIntentId. –°–æ–±—ã—Ç–∏—è –≤ Kafka –¥–ª—è Order Service
- –ë–î: PostgreSQL (payment_db)

**üë§ User Service (user-service)**

- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ—Å–ª–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Keycloak), —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–¥–º–∏–Ω: —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ë–î: PostgreSQL (user_db)

### –ë–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å (Workflow)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—â–µ—Ç —Ä–µ–π—Å (Trip Service) ‚Üí –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ—Å—Ç–∞ (Inventory –ø–æ gRPC) ‚Üí –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–∞—Å—Å–∞–∂–∏—Ä–∞.
2. Booking Service: —Ä–µ–∑–µ—Ä–≤ –º–µ—Å—Ç (gRPC) ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (REST) ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã (REST) ‚Üí –≤–æ–∑–≤—Ä–∞—Ç URL Stripe Checkout.
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –≤ Stripe ‚Üí Webhook ‚Üí Payment Service –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ ‚Üí Order Service –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∑–∞–∫–∞–∑ –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –º–µ—Å—Ç–∞ –≤ CONFIRMED.

### –í—Ä–µ–º–µ–Ω–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (TTL)

- –ú–µ—Å—Ç–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15 –º–∏–Ω—É—Ç), Redis TTL.
- –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: –±—Ä–æ–Ω—å —Å–Ω–∏–º–∞–µ—Ç—Å—è, –∑–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è, –º–µ—Å—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ AVAILABLE.

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–æ–ª–∏

- Keycloak: —Ä–æ–ª–∏ USER (–ø–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤), CARRIER (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Å–∞–º–∏), ADMIN (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ).

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

| –°–≤—è–∑–∫–∞              | –ü—Ä–æ—Ç–æ–∫–æ–ª |
| ------------------- | -------- |
| Booking ‚Üî Inventory | gRPC     |
| Booking ‚Üî Order     | REST     |
| Booking ‚Üî Payment   | REST     |
| –°–æ–±—ã—Ç–∏—è             | Kafka    |

### –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Stripe Webhook –∏ Kafka-—Å–æ–æ–±—â–µ–Ω–∏–π
- –¢–∞–π–º–∞—É—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è (Saga)
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤
